name: Unit Tests of output() util constants
run-name: ${{ github.actor }} is unit testing output() constants
on: [push]
jobs:
  unit-test-output-util-constants:
    runs-on: ubuntu-20.04
    steps:
      - run:  echo "Checking out branch ${{ github.ref }} from ${{ github.repository }} repo on ${{ runner.os }}..."
      - name: Check out repository code
        uses: actions/checkout@v3
      - name: Install shellspec
        run:  curl -fsSL https://git.io/shellspec | sh -s -- --yes
      - name: Install Kcov
        run:  sudo apt-get install binutils-dev libssl-dev libcurl4-openssl-dev zlib1g-dev libdw-dev libiberty-dev
      - name: Install BusyBox shell
        run:  sudo apt-get install busybox
      - name: Checking location where BusyBox was installed
        run:  which busybox
      - name: Check if BusyBox is installed
        run:  busybox --help
      - name: Check version of BusyBox that was installed
        run:  busybox --version
      - name: List installed shells
        run:  cat /etc/shells
      - name: Run unit tests on bash shell with code coverage
        run:  shellspec -s /bin/bash --fail-fast --fail-no-examples --warning-as-failure ./spec/unit/output/util/constants_*
#        run: shellspec -s /bin/bash --fail-fast --fail-no-examples --warning-as-failure --kcov --kcov-options "--include-pattern=src/shell/functions/output/util/constants.sh" --fail-low-coverage ./spec/unit/output/util/constants_*
      - name: Run unit tests on sh shell
        run:  shellspec -s /bin/sh --fail-fast --fail-no-examples --warning-as-failure ./spec/unit/output/util/constants_*
      - name: Run unit tests on dash shell
        run:  shellspec -s /bin/dash --fail-fast --fail-no-examples --warning-as-failure ./spec/unit/output/util/constants_*
      - name: Run unit tests on BusyBox shell
        run:  shellspec -s /usr/bin/busybox --fail-fast --fail-no-examples --warning-as-failure ./spec/unit/output/util/constants_*
#      - name: Run unit tests on zsh shell
#        run:  shellspec -s /path/to/zsh --fail-fast --fail-no-examples --warning-as-failure ./spec/unit/output/util/constants_*

